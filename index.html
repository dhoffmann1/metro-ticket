<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulated Metro Ticket</title>
    <!-- Load Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom font for authenticity, though Inter is used as default */
        body {
            font-family: 'Inter', sans-serif;
            /* Ensure body and html tags take up the full available height */
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0; /* Important: remove default padding/margin */
            margin: 0;
            overflow: hidden; /* Prevent body scrollbar */
        }

        /* ---------------------------------- */
        /* Custom Animation for Scrolling Bar */
        /* ---------------------------------- */

        /* Keyframes for continuous Left-to-Right horizontal scroll,
           scrolling exactly one full container width (100%) */
        @keyframes colorScroll {
            from { background-position: 0% 0; }
            to { background-position: 100% 0; }
        }

        .header-section {
            width: 100%;
            /* UPDATED: 10vh (Half of 20vh header) */
            height: 10vh;
            background-size: 200% 100%; /* Double the width for seamless scrolling */
            background-repeat: repeat-x;
            animation: colorScroll 12s linear infinite;
        }

        /* Top Header: Light Blue and Light Red */
        .header-top {
            background-image:
                linear-gradient(90deg, #2d5dc2 0%, #2d5dc2 50%, #e82449 50%, #e82449 100%);
        }

        /* Bottom Header: Dark Blue and Dark Red */
        .header-bottom {
            background-image:
                linear-gradient(90deg, #1f4095 0%, #1f4095 50%, #c41e3a 50%, #c41e3a 100%);
        }

        /* ---------------------------------- */
        /* Absolute Position for METRO Text */
        /* ---------------------------------- */
        .header-wrapper {
            position: relative;
            /* UPDATED: 20% of the viewport height */
            height: 20vh;
            overflow: hidden;
            z-index: 10;
        }

        .metro-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%); /* Center horizontally and vertically */
            z-index: 20; /* Ensure text is above all color layers */
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            font-size: 6vw; /* Use viewport width for responsive text size */
        }

        /* ---------------------------------- */
        /* Main Content Styling with Image */
        /* ---------------------------------- */
        .main-ticket-area {
            /* Keep light blue background as a fallback */
            background: linear-gradient(to bottom, #d5eaff, #c8e3ff);
            margin-top: 0;
            position: relative;
            /* UPDATED: 65% of the viewport height (100vh - 20vh header - 15vh footer) */
            height: 65vh;
            /* Ensure the content (now the img tag) is centered within the main area */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Style for the new IMG element inside the main area */
        .ticket-image {
            width: 100%;
            height: 100%;
            /* object-fit: contain ensures the full image is visible, even if it leaves space */
            object-fit: contain;
        }

        /* ---------------------------------- */
        /* Combined Footer Styling (Time Bar + Footer Bar) */
        /* ---------------------------------- */
        #ticket-footer {
            /* UPDATED: 15% of the viewport height */
            height: 15vh;
            display: flex;
            flex-direction: column;
            justify-content: stretch; /* Stretch children to fill vertical space */
            background-color: #1f4095; /* Base color for the whole footer */
            color: white;
        }

        /* Dynamic Time Bar Styling - now fills the top part of the 15vh footer */
        .time-bar {
            /* Take 50% of the 15vh footer height (approx 7.5vh) */
            height: 50%;
            background-color: #0b73b5; /* Dark blue background matching the original image's date bar */
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 0 1rem;
            /* UPDATED: Increased font size from 4vw to 5vw */
            font-size: 5vw;
            font-weight: 600;
        }

        /* Expiration Text Area - now fills the bottom part of the 15vh footer */
        .expiration-text-area {
            /* Take 50% of the 15vh footer height (approx 7.5vh) */
            height: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 0 1rem;
        }

        /* Home Screen Specific Styling */
        #home-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            /* UPDATED: Set height to 100vh to ensure it fills the entire viewport */
            height: 100vh;
            width: 100vw; /* Ensure it's full width as well */
            position: fixed; /* Fix position to ensure it covers everything outside the ticket view */
            top: 0;
            left: 0;
            background-color: #ecf0f1; /* Light gray background for home screen */
            z-index: 50; /* Ensure it sits above the app-container's background, though app-container is already full screen */
        }

        .ticket-button {
            padding: 1.5rem 3rem;
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
            background-color: #2980b9; /* Darker blue button color */
            border-radius: 0.75rem; /* Rounded corners */
            box-shadow: 0 6px #1f6899; /* Shadow for 3D press effect */
            transition: all 0.1s;
        }

        .ticket-button:active {
            transform: translateY(3px);
            box-shadow: 0 3px #1f6899;
        }

    </style>
</head>
<body class="p-0 m-0">
    <!-- CRITICAL CHANGE: Removed max-w-sm and h-[85vh], added min-h-screen for full viewport height -->
    <div id="app-container" class="w-full min-h-screen bg-white shadow-2xl overflow-hidden flex flex-col">

        <!-- This is the main content target for conditional rendering -->
        <!-- FIX: Added h-full to app-content to ensure it uses the full height of its container (app-container) -->
        <div id="app-content" class="h-full flex flex-col">
            <!-- Content will be injected here by JavaScript -->
        </div>

    </div>

    <script>
        // State variable to track the current view: 'home' or 'ticket'
        let appState = 'home';
        const appContent = document.getElementById('app-content');

        // Global variable for time display element
        let timeDisplay = null;

        /**
         * Calculates the ticket expiration time (3 hours from now)
         * and formats it as MM/DD/YYYY at HH:MM PM/AM.
         */
        function updateTicketTime() {
            // Ensure timeDisplay element exists before trying to update it
            if (!timeDisplay) {
                timeDisplay = document.getElementById('time-display');
            }
            if (!timeDisplay) return;

            // Get the current date and time
            const now = new Date();
            // Calculate the expiration time (3 hours later)
            now.setHours(now.getHours() + 3);

            // Options for date formatting
            const dateOptions = {
                month: '2-digit',
                day: '2-digit',
                year: 'numeric'
            };

            // Options for time formatting
            const timeOptions = {
                hour: '2-digit',
                minute: '2-digit',
                hour12: true
            };

            // Format the date and time strings
            const formattedDate = now.toLocaleDateString('en-US', dateOptions);
            const formattedTime = now.toLocaleTimeString('en-US', timeOptions);

            // Construct the final string and update the display
            timeDisplay.textContent = `${formattedDate} at ${formattedTime.replace(' ', ' ')}`;
        }

        /**
         * Renders the home screen with the "Open Ticket" button.
         */
        function renderHome() {
            // NOTE: The #home-screen CSS ensures it takes up 100vh and centers the content.
            appContent.innerHTML = `
                <div id="home-screen">
                    <h1 class="text-3xl font-semibold mb-8 text-gray-700">Metro Transit App</h1>
                    <button class="ticket-button" onclick="showTicket()">
                        Open Ticket
                    </button>
                </div>
            `;
            appState = 'home';
        }

        /**
         * Renders the full ticket view.
         */
        function renderTicket() {
            appContent.innerHTML = `
                <!-- 1. Scrolling Header Bar (Blue/Red) -->
                <header class="header-wrapper">

                    <!-- Top Color Half (Light Blue / Light Red) -->
                    <div class="header-section header-top"></div>

                    <!-- Bottom Color Half (Dark Blue / Dark Red) -->
                    <div class="header-section header-bottom"></div>

                    <!-- Absolute Centered Text -->
                    <h1 class="metro-text text-4xl font-extrabold text-white tracking-widest">METRO</h1>

                </header>

                <!-- 2. Main Ticket Body (Static Image) -->
                <!-- Set to height: 65vh -->
                <main class="main-ticket-area flex flex-col justify-end p-0">
                    <!-- IMAGE TAG REPLACING CSS BACKGROUND IMAGE -->
                    <img
                        src="ticket-bg.jpg"
                        class="ticket-image"
                        alt="Local Single Ride Ticket Background with QR Code"
                        onerror="this.onerror=null;this.src='https://placehold.co/1600x1200/C8E3FF/1F4095?text=LOCAL+SINGLE+RIDE%0A%0AQR+CODE';"
                    />
                </main>

                <!-- 3. Combined Dynamic Footer (Time Bar + Expiration Text) -->
                <footer id="ticket-footer">
                    <!-- Time Bar (Top 50% of 15vh footer) -->
                    <div class="time-bar">
                        <p id="time-display"></p>
                    </div>

                    <!-- Expiration Text Area (Bottom 50% of 15vh footer) -->
                    <div class="expiration-text-area">
                        <p id="expiration-text" class="text-xl font-semibold tracking-wider uppercase">
                            Ticket Expiration
                        </p>
                    </div>
                </footer>
            `;
            appState = 'ticket';

            // Re-identify the timeDisplay element now that the ticket HTML is rendered
            timeDisplay = document.getElementById('time-display');

            // CRITICAL: Calculate and display the time NOW when the ticket is opened
            updateTicketTime();
        }

        /**
         * Public function to switch to the ticket view and manage history.
         */
        window.showTicket = function() {
            // Only push a state if we are currently on the home screen (to prevent duplicate history entries)
            if (appState === 'home') {
                history.pushState({ screen: 'ticket' }, 'Ticket Active');
            }
            renderTicket();
        }

        /**
         * Public function to switch back to the home view.
         */
        window.showHome = function() {
            renderHome();
        }

        // --- Back Button Listener ---
        // This listens for the user clicking the browser's back button
        // (which simulates the physical back button on Android).
        window.onpopstate = function(event) {
            // Check if we are moving away from a 'ticket' state
            if (appState === 'ticket') {
                renderHome();
            }
        };

        // Initialize the application to the home screen
        document.addEventListener('DOMContentLoaded', () => {
             // Use replaceState to set the initial state without adding a back button entry
            history.replaceState({ screen: 'home' }, 'Metro Home');
            renderHome();
        });
    </script>
</body>
</html>
